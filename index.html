<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notepad & Task Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        /* Existing styles omitted for brevity */

        /* Template List Modal */
        #templateListModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        #templateList {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            width: 300px;
        }
        #templateList li {
            padding: 10px;
            cursor: pointer;
        }
        #templateList li:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Existing content omitted for brevity -->

        <!-- Template Save/Load buttons -->
        <button id="saveTemplateButton">Save Template</button>
        <button id="loadTemplateButton">Load Template</button>

        <!-- Template List Modal (hidden initially) -->
        <div id="templateListModal">
            <ul id="templateList"></ul>
        </div>
    </div>

    <script>
        // Existing code (Theme toggle, font size controls, etc.) omitted for brevity

        // Template feature
        const saveTemplateButton = document.getElementById('saveTemplateButton');
        const loadTemplateButton = document.getElementById('loadTemplateButton');
        const templateListModal = document.getElementById('templateListModal');
        const templateList = document.getElementById('templateList');
        let templates = JSON.parse(localStorage.getItem('templates')) || [];

        // Save the current state as a template
        saveTemplateButton.addEventListener('click', () => {
            const templateName = prompt("Enter a name for your template:");
            if (templateName) {
                // Check if the template name already exists
                if (templates.some(template => template.name === templateName)) {
                    alert("Template name already exists. Choose a different name.");
                    return;
                }
                const newTemplate = {
                    name: templateName,
                    noteContent: notepad.value,
                    tasks: tasks,
                    savedAt: new Date().toLocaleString()
                };
                templates.push(newTemplate);
                localStorage.setItem('templates', JSON.stringify(templates));
                alert("Template saved!");
            }
        });

        // Load the template list modal
        loadTemplateButton.addEventListener('click', () => {
            templateListModal.style.display = 'flex';
            renderTemplateList();  // Show the list of saved templates
        });

        // Render the list of templates
        function renderTemplateList() {
            templateList.innerHTML = '';  // Clear existing list
            templates.forEach((template, index) => {
                const listItem = document.createElement('li');
                listItem.textContent = `${template.name} (Saved: ${template.savedAt})`;
                listItem.addEventListener('click', () => {
                    loadTemplate(template);  // Load the selected template
                    templateListModal.style.display = 'none';  // Close the modal
                });
                templateList.appendChild(listItem);
            });
        }

        // Load the selected template
        function loadTemplate(template) {
            notepad.value = template.noteContent;
            tasks = template.tasks;
            renderTasks();  // Render tasks from the loaded template
        }

        // Close the template list modal if clicked outside
        templateListModal.addEventListener('click', (e) => {
            if (e.target === templateListModal) {
                templateListModal.style.display = 'none';
            }
        });

        // Task List Persistence
        const taskList = document.getElementById('taskList');
        const taskInput = document.getElementById('taskInput');
        const addTaskButton = document.getElementById('addTaskButton');
        const clearAllButton = document.getElementById('clearAllButton');

        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

        function renderTasks() {
            taskList.innerHTML = '';
            tasks.forEach((task, index) => {
                const li = document.createElement('li');
                li.classList.add('task');
                li.innerHTML = `
                    <input type="checkbox" ${task.completed ? 'checked' : ''} data-index="${index}" />
                    <span style="text-decoration: ${task.completed ? 'line-through' : 'none'};">${task.text}</span>
                    <button class="deleteBtn" data-index="${index}">X</button>
                `;
                taskList.appendChild(li);
            });
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        addTaskButton.addEventListener('click', () => {
            const taskText = taskInput.value.trim();
            if (taskText) {
                tasks.push({ text: taskText, completed: false });
                taskInput.value = '';
                renderTasks();
            }
        });

        taskList.addEventListener('click', (e) => {
            if (e.target.classList.contains('deleteBtn')) {
                const index = e.target.getAttribute('data-index');
                tasks.splice(index, 1);
                renderTasks();
            } else if (e.target.type === 'checkbox') {
                const index = e.target.getAttribute('data-index');
                tasks[index].completed = e.target.checked;
                renderTasks();
            }
        });

        clearAllButton.addEventListener('click', () => {
            tasks = [];
            renderTasks();
        });

        renderTasks();  // Initial render of tasks

        // Timezone Display Function
        function updateTimezone() {
            const date = new Date();
            document.getElementById('usPacific').textContent = `US Pacific: ${date.toLocaleString('en-US', { timeZone: 'America/Los_Angeles' })}`;
            document.getElementById('usMountain').textContent = `US Mountain: ${date.toLocaleString('en-US', { timeZone: 'America/Denver' })}`;
            document.getElementById('usCentral').textContent = `US Central: ${date.toLocaleString('en-US', { timeZone: 'America/Chicago' })}`;
            document.getElementById('usEastern').textContent = `US Eastern: ${date.toLocaleString('en-US', { timeZone: 'America/New_York' })}`;
            document.getElementById('phPhilippines').textContent = `PH Philippines: ${date.toLocaleString('en-US', { timeZone: 'Asia/Manila' })}`;
        }

        updateTimezone();
        setInterval(updateTimezone, 1000);
    </script>
</body>
</html>
