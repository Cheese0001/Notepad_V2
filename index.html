const taskInput = document.getElementById('taskInput');
const addTaskButton = document.getElementById('addTaskButton');
const taskList = document.getElementById('taskList');
const clearAllButton = document.getElementById('clearAllButton');

// Add a new task
addTaskButton.addEventListener('click', () => {
  const taskContent = taskInput.value;
  if (taskContent.trim()) {
    const task = {
      content: taskContent,
      completed: false,
    };

    // Save the task to localStorage
    let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
    tasks.push(task);
    localStorage.setItem('tasks', JSON.stringify(tasks));

    // Add task to the list
    addTaskToList(task);
    taskInput.value = ''; // Clear the input
  }
});

// Mark task as completed or delete task
function addTaskToList(task) {
  const taskItem = document.createElement('li');
  taskItem.className = 'task';

  const taskText = document.createElement('span');
  taskText.textContent = task.content;
  if (task.completed) {
    taskText.style.textDecoration = 'line-through';
  }

  const checkBox = document.createElement('input');
  checkBox.type = 'checkbox';
  checkBox.checked = task.completed;
  checkBox.addEventListener('change', () => {
    task.completed = checkBox.checked;
    taskText.style.textDecoration = task.completed ? 'line-through' : '';
    saveTasks();
  });

  const deleteButton = document.createElement('button');
  deleteButton.textContent = 'X';
  deleteButton.className = 'delete-button';
  deleteButton.addEventListener('click', () => {
    taskItem.remove();
    removeTask(task);
    saveTasks();
  });

  taskItem.appendChild(checkBox);
  taskItem.appendChild(taskText);
  taskItem.appendChild(deleteButton);
  taskList.appendChild(taskItem);
}

// Save tasks to localStorage
function saveTasks() {
  const tasks = [];
  document.querySelectorAll('.task').forEach(taskItem => {
    const taskContent = taskItem.querySelector('span').textContent;
    const taskCompleted = taskItem.querySelector('input[type="checkbox"]').checked;
    tasks.push({
      content: taskContent,
      completed: taskCompleted,
    });
  });
  localStorage.setItem('tasks', JSON.stringify(tasks));
}

// Remove task from localStorage
function removeTask(task) {
  let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
  tasks = tasks.filter(t => t.content !== task.content);
  localStorage.setItem('tasks', JSON.stringify(tasks));
}

// Clear all tasks
clearAllButton.addEventListener('click', () => {
  taskList.innerHTML = '';
  localStorage.removeItem('tasks');
});

// Load tasks from localStorage when the page is loaded
window.addEventListener('DOMContentLoaded', () => {
  let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
  tasks.forEach(task => addTaskToList(task));
});
